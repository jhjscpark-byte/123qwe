<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>편두통 포괄적 관리 대시보드</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        mg: {
                            base: '#FFFFF0', // Ivory
                            dark: '#1a202c',
                            primary: '#2E8B57', // SeaGreen
                            accent: '#556B2F', // DarkOliveGreen
                            light: '#F0FFF4',
                            text: '#2F4F4F' // DarkSlateGray
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; transition: background-color 0.3s, color 0.3s; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .glass { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); }
        .dark .glass { background: rgba(30, 41, 59, 0.7); }
        
        /* Custom Scrollbar for sidebar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #2E8B57; border-radius: 4px; }
    </style>
</head>
<body class="bg-mg-base text-mg-text dark:bg-gray-900 dark:text-gray-100 transition-colors duration-300">

    <div class="flex h-screen overflow-hidden">
        
        <!-- Sidebar Navigation -->
        <aside class="w-64 bg-mg-primary text-ivory flex-shrink-0 hidden md:flex flex-col shadow-xl z-20">
            <div class="p-6 text-center border-b border-green-600">
                <h1 class="text-2xl font-bold text-white"><i class="fas fa-brain mr-2"></i>Migraine<br><span class="text-sm font-light text-green-100">Care Dashboard</span></h1>
            </div>
            <nav class="flex-1 overflow-y-auto py-4 px-2 space-y-1" id="sidebar-nav">
                <!-- Nav items generated by JS -->
            </nav>
            <div class="p-4 border-t border-green-600 text-xs text-green-100 text-center">
                2025 Updates Applied
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col overflow-hidden relative">
            
            <!-- Header -->
            <header class="glass h-16 flex items-center justify-between px-6 shadow-sm z-10 sticky top-0">
                <div class="flex items-center">
                    <button id="mobile-menu-btn" class="md:hidden mr-4 text-mg-primary dark:text-green-400">
                        <i class="fas fa-bars fa-lg"></i>
                    </button>
                    <div class="relative">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                        <input type="text" id="search-input" placeholder="키워드 검색 (예: 전조, 약물)" 
                            class="pl-10 pr-4 py-2 rounded-full border border-green-200 bg-white dark:bg-gray-800 dark:border-gray-700 focus:outline-none focus:ring-2 focus:ring-mg-primary text-sm w-64 transition-all">
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <span class="text-sm font-medium hidden sm:block text-mg-primary dark:text-green-300">
                        <i class="fas fa-calendar-alt mr-1"></i> 관리 모드
                    </span>
                    <!-- Theme Toggle -->
                    <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors focus:outline-none">
                        <i class="fas fa-moon text-gray-600 dark:hidden"></i>
                        <i class="fas fa-sun text-yellow-400 hidden dark:block"></i>
                    </button>
                </div>
            </header>

            <!-- Dashboard Content Scroll Area -->
            <div class="flex-1 overflow-y-auto p-6 scroll-smooth" id="main-scroll">
                
                <!-- Intro Hero -->
                <div class="bg-gradient-to-r from-mg-primary to-green-700 rounded-2xl p-8 mb-8 text-white shadow-lg relative overflow-hidden">
                    <div class="relative z-10">
                        <h2 class="text-3xl font-bold mb-2">편두통의 포괄적 이해와 관리 전략</h2>
                        <p class="text-green-100 max-w-2xl">편두통은 단순한 두통이 아닌 신경계 질환입니다. 정확한 진단, 단계별 증상 이해, 그리고 SEEDS 전략을 통한 생활 습관 관리가 필요합니다.</p>
                        <div class="mt-6 flex space-x-3">
                            <button onclick="scrollToSection('sec-1')" class="bg-white text-mg-primary px-4 py-2 rounded-lg font-bold hover:bg-green-50 transition shadow">시작하기</button>
                            <button onclick="scrollToSection('sec-20')" class="bg-green-800 bg-opacity-50 text-white px-4 py-2 rounded-lg hover:bg-opacity-70 transition">결론 보기</button>
                        </div>
                    </div>
                    <i class="fas fa-notes-medical absolute -right-6 -bottom-6 text-9xl text-white opacity-10"></i>
                </div>

                <!-- Grid Layout for Cards -->
                <div id="content-grid" class="grid grid-cols-1 xl:grid-cols-2 gap-6">
                    <!-- Content will be injected via JS -->
                </div>
                
                <footer class="mt-12 text-center text-sm text-gray-500 pb-8">
                    &copy; 2025 Migraine Comprehensive Guide Dashboard. Designed for Patient Education.
                </footer>
            </div>
        </main>
    </div>

    <!-- Modal for Detailed Info -->
    <div id="info-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto transform transition-all scale-95 opacity-0" id="modal-content">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4 border-b pb-2 border-green-100 dark:border-gray-700">
                    <h3 class="text-xl font-bold text-mg-primary dark:text-green-400" id="modal-title">상세 정보</h3>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-red-500"><i class="fas fa-times fa-lg"></i></button>
                </div>
                <div id="modal-body" class="prose dark:prose-invert max-w-none text-sm leading-relaxed">
                    <!-- Dynamic Content -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data & Content (Extracted from Prompt)
        const migraineData = [
            {
                id: 'sec-1', title: '1. 편두통의 정의와 부담', icon: 'fa-chart-pie',
                shortDesc: '전 세계 인구의 10~15%가 앓는 흔한 뇌질환, 장애생활연수 2위.',
                fullText: `편두통은 전 세계 인구의 약 10~15%가 앓고 있는 매우 흔한 뇌질환으로, 국내 성인 유병률은 약 17%에 달함. 2016년 세계질병부담연구에 따르면 편두통은 당뇨병이나 조울증보다 '장애생활연수'가 긴, 전 세계 질병 부담 2위의 질환임. 편두통의 핵심 정의 및 특성은 뇌신경 및 뇌혈관 기능 이상으로 발생하는 반복적인 두통으로, 박동성 통증과 구역, 구토, 빛·소리 공포증을 동반하는 만성 신경계 질환임. 성별 및 연령별 발생 양상은 남성(12.8%)보다 여성(25.9%)에서 약 2~3배 더 많이 발생하며, 학업 및 경제활동이 활발한 10대부터 40대까지 큰 타격을 줌. 사회경제적 영향의 심각성: 편두통 환자들은 한 달에 평균 24일 이상 작업 능률이 절반 이하로 감소하며, 결석이나 결근 등 일상생활에 심각한 지장을 초래함. 진단 지연 문제와 인식 개선: 첫 증상 경험 후 확진까지 평균 10년이 소요될 정도로 방치되는 경우가 많아, 단순 두통이 아닌 치료가 필요한 '질환'이라는 인식 제고가 필수적임.`,
                hasChart: true, chartType: 'bar',
                table: { headers: ['구분', '내용', '비고'], rows: [['국내 유병률', '성인 약 8~17%', '여성>남성 3배'], ['질병 부담', '세계 2위', 'GBD 2016'], ['진단 소요', '평균 10년', '낮은 인식']] }
            },
            {
                id: 'sec-2', title: '2. 임상 단계와 진행 패턴', icon: 'fa-hourglass-half',
                shortDesc: '전구기-전조기-두통기-후구기 4단계 진행, 빈도에 따라 만성 분류.',
                fullText: `편두통은 단순히 머리가 아픈 시간만을 의미하지 않으며, 두통 발생 전후로 다양한 신경학적 변화가 나타나는 4단계의 과정을 거침. 1. 전구 증상기: 두통 발생 수 시간~이틀 전 피로, 집중력 저하, 뒷목 뻣뻣함 등. 2. 전조기(조짐): 두통 직전 5~60분간 시각적 섬광암점이나 감각 장애가 나타남. 3. 두통 발작기: 4~72시간 지속되는 박동성 통증, 구역/구토 동반. 4. 후구기: 두통 소멸 후 쇠약감, 근육통, 사고 기능 저하. 한 달에 두통 일수가 15일 이상(3개월 초과)이면 만성 편두통, 그 미만이면 삽화 편두통으로 분류함.`,
                hasVisualization: true, visType: 'timeline',
                table: { headers: ['단계', '시간', '주요 증상'], rows: [['전구기', '수 시간~2일', '피로, 식욕변화'], ['전조기', '5~60분', '시각/감각 이상'], ['두통기', '4~72시간', '박동성 통증'], ['후구기', '~수 일', '무력감']] }
            },
            {
                id: 'sec-3', title: '3. 조짐(전조)의 특징', icon: 'fa-bolt',
                shortDesc: '환자의 1/3 경험. 시각 조짐(섬광암점)이 가장 흔함.',
                fullText: `전체 편두통 환자의 약 1/3은 두통 발생 전 신경학적 장애인 전조(조짐)를 경험함. 가장 흔한 시각 조짐은 시야 중심에서 시작해 지그재그 성벽 모양으로 퍼지는 섬광암점임. 감각 및 언어 조짐: 30~40%는 손/얼굴 저림, 10~20%는 언어 장애를 겪음. 증상은 5분 이상 서서히 진행되어 60분 이내 종료됨. 드물게 반신마비나 뇌간 조짐이 나타날 수 있으며, 두통 없이 전조만 나타나는 '침묵의 편두통'도 존재함.`,
                hasVisualization: true, visType: 'aura-sim',
                table: { headers: ['유형', '빈도', '증상'], rows: [['시각', '99%', '섬광, 암점'], ['감각', '30~40%', '저림, 따끔거림'], ['언어', '10~20%', '발음/이해 곤란']] }
            },
            {
                id: 'sec-4', title: '4. 주요 유발 요인(Trigger)', icon: 'fa-exclamation-triangle',
                shortDesc: '스트레스, 수면, 공복, 빛/소리 등 뇌 과활성화 요인.',
                fullText: `편두통은 개인의 역치를 넘어서는 과도한 뇌 활성화로 촉발됨. 1. 스트레스: 가장 큰 원인, 긴장이 풀릴 때도 발생. 2. 수면: 부족하거나 과도한 수면 모두 트리거. 3. 공복: 저혈당이 신경 자극, 끼니 거르지 말 것. 4. 감각 자극: 강한 빛, 냄새, 소음, 날씨 변화. 5. 호르몬: 월경 전후 에스트로겐 급감. 개인마다 유발 요인이 다르므로 파악이 중요함.`,
                hasChart: true, chartType: 'radar',
                table: { headers: ['카테고리', '요인', '관리'], rows: [['생리적', '스트레스/수면/공복', '루틴 유지'], ['감각적', '빛/소리/냄새', '회피'], ['호르몬', '월경', '집중 관리']] }
            },
            {
                id: 'sec-5', title: '5. 식단 관리 가이드', icon: 'fa-utensils',
                shortDesc: '티라민(치즈, 와인) 제한, 마그네슘/오메가3 섭취 권장.',
                fullText: `잘못된 식단은 뇌혈관을 자극함. 제한 식품: 와인, 치즈의 '티라민', 가공육의 아질산염, MSG 등은 혈관 수축/팽창을 유발함. 카페인: 일시적 완화 효과 있으나 과용 시 혈관 민감도 증가 및 금단 두통 유발. 권장 식품: 시금치, 아몬드(마그네슘), 연어, 고등어(오메가3)는 신경 안정 및 항염증 효과. 비타민 B2가 풍부한 버섯도 도움됨.`,
                hasVisualization: true, visType: 'food-list',
                table: { headers: ['구분', '식품', '이유'], rows: [['제한', '치즈, 와인', '티라민/혈관자극'], ['주의', '커피, 콜라', '카페인 의존'], ['권장', '시금치, 생선', '마그네슘/항염']] }
            },
            {
                id: 'sec-6', title: '6. 두통 일기의 중요성', icon: 'fa-book-medical',
                shortDesc: '진단과 유발 인자 파악의 핵심 도구. 앱 활용 권장.',
                fullText: `두통 일기는 환자 상태 파악과 정확한 진단의 필수 도구임. 필수 항목: 날짜, 시간, 강도(0-10), 양상, 동반 증상, 약물 효과. 추가 정보: 식사, 수면, 날씨, 월경 주기 등을 기록해 유발 요인 분석. 디지털 앱(Migraine Buddy 등)을 활용하면 데이터 시각화와 리포트 생성이 용이함. 꾸준한 기록은 난치성 진행을 막고 생활 습관 개선의 근거가 됨.`,
                hasVisualization: true, visType: 'app-mockup',
                table: { headers: ['항목', '내용', '목적'], rows: [['통증', '시간/강도', '장애 평가'], ['동반증상', '구토/전조', '유형 분류'], ['환경', '수면/식사', '트리거 식별']] }
            },
            {
                id: 'sec-7', title: '7. 급성기 치료 원칙', icon: 'fa-pills',
                shortDesc: '통증 시작 1시간 이내 복용이 핵심. 일반 진통제 오남용 주의.',
                fullText: `급성기 치료는 통증 발생 즉시(1시간 이내) 복용하여 신경 감작을 막는 것이 핵심임. 일반 진통제(타이레놀, NSAIDs)는 경도-중등도 통증에 효과적이나, 주 2일 이상 복용 시 '약물 과용 두통' 위험이 있음. 복합 진통제(마이드린 등)도 남용 주의. 조기 복용이 통증 조절 효과를 극대화함.`,
                hasVisualization: true, visType: 'clock-warning',
                table: { headers: ['성분', '용량', '주의'], rows: [['아세트아미노펜', '500-1000mg', '간독성'], ['나프록센', '250-500mg', '위장장애'], ['복합제', '1-2캡슐', '남용주의']] }
            },
            {
                id: 'sec-8', title: '8. 트립탄(Triptans) 계열', icon: 'fa-capsules',
                shortDesc: '편두통 특이 약물. 혈관 수축 작용으로 강력한 효과.',
                fullText: `트립탄은 세로토닌 수용체에 작용해 뇌혈관을 수축시키는 편두통 전용 치료제임. 통증 시작 1시간 이내 복용 시 가장 효과적. 종류: 수마트립탄, 졸미트립탄, 알모트립탄 등. 부작용: 가슴 조임, 졸음 등. 금기: 심근경색, 뇌졸중, 조절 안 되는 고혈압 환자 등 혈관 질환자는 사용 금지.`,
                hasChart: true, chartType: 'doughnut',
                table: { headers: ['성분', '특징', '반감기'], rows: [['Sumatriptan', '표준 치료제', '2시간'], ['Almotriptan', '높은 내약성', '3-4시간'], ['Frovatriptan', '긴 지속시간', '26시간']] }
            },
            {
                id: 'sec-9', title: '9. 신약: 지판트 & 디탄', icon: 'fa-dna',
                shortDesc: '혈관 수축 없는 최신 치료제. 심혈관 질환자 사용 가능.',
                fullText: `기존 트립탄을 못 쓰는 환자를 위한 신약. 지판트(Gepants, 너텍 등): CGRP 수용체 차단, 혈관 수축 부작용 없어 심장 질환자에 안전. 급성/예방 동시 효과 가능. 디탄(Ditans, 라스미디탄): 세로토닌 수용체 작용, 혈관 수축 없이 통증만 차단. 단, 중추신경 부작용(어지러움)으로 운전 주의 필요.`,
                hasVisualization: true, visType: 'molecule',
                table: { headers: ['성분', '계열', '특징'], rows: [['Rimegepant', '지판트', '예방 겸용'], ['Lasmiditan', '디탄', '혈관영향無'], ['Ubrogepant', '지판트', '경구용']] }
            },
            {
                id: 'sec-10', title: '10. 예방 치료 가이드', icon: 'fa-shield-alt',
                shortDesc: '월 4-6회 이상 두통 시 권장. 빈도와 강도 50% 감소 목표.',
                fullText: `예방 치료는 두통 빈도, 강도를 줄여 삶의 질을 높이는 근본 치료임. 목표: 월 두통 횟수 50% 이상 감소. 대상: 월 4일 이상 두통+장애 동반, 급성기 약물 과용자 등. 효과 판정: 최소 2개월 이상 사용 후 평가. 효과 확인 시 3~6개월 유지 후 감량. 꾸준한 복용이 중요함.`,
                hasVisualization: true, visType: 'target-chart',
                table: { headers: ['대상 기준', '조건', '비고'], rows: [['권고', '월 6일 이상', '장애 무관'], ['권고', '월 4일 이상', '중등도 장애'], ['필수', '약물과용', '만성확진']] }
            },
            {
                id: 'sec-11', title: '11. 경구 예방 약물', icon: 'fa-tablets',
                shortDesc: '베타차단제, 뇌전증약, 항우울제 등을 차용하여 사용.',
                fullText: `기존 질환 치료제 중 편두통 예방 효과 입증된 약물 사용. 베타차단제(프로프라놀롤): 고혈압/불안 환자에 적합. 뇌전증약(토피라메이트): 체중 감소 효과, 손저림 주의. 항우울제(아미트리프틸린): 불면/긴장형 두통 동반 시 유용. 칼슘차단제(플루나리진): 어지럼증 동반 시 효과적. 저용량 시작 후 점진적 증량 원칙.`,
                hasVisualization: true, visType: 'pill-types',
                table: { headers: ['약물군', '성분', '선택 기준'], rows: [['베타차단제', 'Propranolol', '고혈압/불안'], ['항경련제', 'Topiramate', '비만/만성'], ['항우울제', 'Amitriptyline', '불면증']] }
            },
            {
                id: 'sec-12', title: '12. 주사 치료: 보톡스', icon: 'fa-syringe',
                shortDesc: '만성 편두통 예방 승인. 31개 부위 12주 간격 주사.',
                fullText: `보톡스는 만성 편두통 예방 치료제로 FDA 승인됨. 기전: 삼차신경 말단에서 통증 전달 물질 차단. 방법: 이마, 관자, 뒷머리, 어깨 등 31곳에 주사, 3개월 간격. 효과: 3회 시술 시 70% 환자에서 두통일 50% 감소. 장점: 매일 약 먹는 번거로움 없음, 부작용 적음. 단점: 고비용.`,
                hasVisualization: true, visType: 'botox-map',
                table: { headers: ['지표', '결과(COMPEL)', '해석'], rows: [['두통일수', '-10.7일', '50% 감소'], ['HIT-6', '-7.1점', '삶의질 개선'], ['우울/불안', '80% 개선', '심리 안정']] }
            },
            {
                id: 'sec-13', title: '13. 주사 치료: CGRP 항체', icon: 'fa-bullseye',
                shortDesc: '편두통 전용 표적 치료제(앰겔러티, 아조비 등). 부작용 적음.',
                fullText: `CGRP 단클론항체는 편두통 발병 핵심 물질인 CGRP를 직접 차단하는 최초의 전용 예방약. 종류: 앰겔러티, 아조비(피하주사), 바이엡티(정맥주사). 특징: 효과 빠름(1주 내), 간/신장 독성 없음, 중추신경 부작용 거의 없음. 국내 급여: 3종 이상 예방약 실패 시 적용 가능. 편의성이 매우 높음.`,
                hasVisualization: true, visType: 'antibody',
                table: { headers: ['제품명', '성분', '투여법'], rows: [['앰겔러티', 'Galcanezumab', '월 1회 SC'], ['아조비', 'Fremanezumab', '월/분기 SC'], ['바이엡티', 'Eptinezumab', '3개월 IV']] }
            },
            {
                id: 'sec-14', title: '14. 약물 과용 두통 (MOH)', icon: 'fa-skull-crossbones',
                shortDesc: '진통제 남용이 부르는 악순환. 과용 중단이 최우선.',
                fullText: `진통제를 너무 자주 먹어 뇌의 통증 조절 기능이 망가져 두통이 심해지는 상태. 기준: 트립탄 월 10일, 단순 진통제 월 15일 이상. 치료: 원인 약물 즉시 중단이 핵심. 금단 두통 발생 시 스테로이드나 예방 주사 병행. 예방: 두통 일기 기록 및 복용 횟수 제한 교육 필수.`,
                hasChart: true, chartType: 'bar-moh',
                table: { headers: ['약물', '과용 기준', '예시'], rows: [['특이약물', '10일/월', '트립탄'], ['복합제', '10일/월', '게보린 등'], ['단순제', '15일/월', '타이레놀']] }
            },
            {
                id: 'sec-15', title: '15. 생활 관리: SEEDS', icon: 'fa-seedling',
                shortDesc: '수면, 운동, 식사, 일기, 스트레스 관리의 5원칙.',
                fullText: `약물만큼 중요한 생활 습관 관리 전략 SEEDS. S(Sleep): 규칙적 수면, 7-8시간. E(Exercise): 주 3-5회 유산소 운동, 약물급 효과. E(Eat): 규칙적 식사, 물 2L 섭취(탈수 예방). D(Diary): 일기 쓰기로 유발 요인 파악. S(Stress): 명상, 이완 요법으로 뇌 긴장 완화. 이를 통해 발작 빈도 획기적 감소 가능.`,
                hasVisualization: true, visType: 'seeds-cards',
                table: { headers: ['요소', '실천 내용', '효과'], rows: [['Sleep', '규칙적 패턴', '뇌 안정'], ['Exercise', '유산소 운동', '스트레스 해소'], ['Eat', '수분/규칙식사', '저혈당 방지']] }
            },
            {
                id: 'sec-16', title: '16. 비약물적 치료 & 이완', icon: 'fa-spa',
                shortDesc: '냉찜질, 명상, 호흡법 등 보조적 완화 수단.',
                fullText: `약물 외 신체/심리 긴장 완화법. 냉찜질: 혈관 수축 및 감각 둔화로 통증 완화. 마음챙김 명상(MBSR): 스트레스 조절 능력 향상. 복식 호흡: 산소 공급 및 부교감신경 활성화. 요가: 신체 밸런스 및 긴장 완화. 빛/소리 차단하고 휴식하기는 가장 기초적인 대처법임.`,
                hasVisualization: true, visType: 'relax',
                table: { headers: ['요법', '방법', '기전'], rows: [['냉찜질', '얼음팩 적용', '혈관수축'], ['명상', 'MBSR', '통증조절력'], ['호흡', '복식호흡', '이완반응']] }
            },
            {
                id: 'sec-17', title: '17. 전자약 & 보완 요법', icon: 'fa-microchip',
                shortDesc: '삼차신경 자극 기기(전자약) 및 영양제 활용.',
                fullText: `새로운 치료 영역. 전자약(ELEXIR 등): 이마에 부착해 삼차신경에 미세 전류 자극, 통증 신호 차단 및 예방 효과. 부작용 적음. 보조제: 마그네슘, 비타민 B2, 코엔자임 Q10 등은 뇌 에너지 대사 개선 도움. EFT 두드리기 등 심리 요법도 보조적으로 활용 가능. 환자의 자기 효능감 증진.`,
                hasVisualization: true, visType: 'device',
                table: { headers: ['구분', '내용', '특징'], rows: [['전자약', '삼차신경자극', '약물부작용無'], ['영양제', 'Mg, B2, CoQ10', '대사 개선'], ['심리', 'EFT', '정서 안정']] }
            },
            {
                id: 'sec-18', title: '18. 임신 중 편두통 관리', icon: 'fa-baby-carriage',
                shortDesc: '약물 제한적 사용. 타이레놀, 비약물 요법 우선.',
                fullText: `임신 중엔 호르몬 변화로 50-80%가 호전되나 관리가 필요함. 원칙: 비약물 치료(휴식, 수분) 우선. 급성기 약물: 아세트아미노펜(안전), 맥각제/NSAIDs(주의/금기). 예방 약물: 초기 피함, 필요 시 마그네슘이나 소량 베타차단제 고려. 발프로산 등 기형 유발 약물 절대 금기. 전자간증 위험 관리 필요.`,
                hasVisualization: true, visType: 'pregnancy',
                table: { headers: ['시기', '권장', '금기'], rows: [['전 기간', '비약물, 타이레놀', '맥각제'], ['1분기', '약물 최소화', '발프로산'], ['예방', '마그네슘', '토피라메이트']] }
            },
            {
                id: 'sec-19', title: '19. 환자 경험 분석(NLP)', icon: 'fa-comments',
                shortDesc: '소셜 미디어 분석을 통한 실제 환자 고충 파악.',
                fullText: `최신 AI/NLP 기술로 트위터, 레딧 등의 환자 경험 분석. 결과: CGRP 항체/지판트에 긍정적 감성 높음. 고충: 약물 후 피로감, 보험/비용 문제 등 실제 장벽 확인. 의의: 임상 시험 외 리얼월드 데이터(RWD)로서 치료 순응도 및 삶의 질 개선 방향 제시에 활용.`,
                hasVisualization: true, visType: 'nlp-cloud',
                table: { headers: ['분석 대상', '방법', '결과'], rows: [['SNS 데이터', 'NLP/머신러닝', '실제경험 포착'], ['약물 감성', 'VADER 분석', '신약 선호도↑'], ['주요 이슈', '토픽 모델링', '비용/피로감']] }
            },
            {
                id: 'sec-20', title: '20. 결론: 예방과 동행', icon: 'fa-hands-helping',
                shortDesc: '완치보다 관리. 교육과 맞춤 치료로 삶의 질 회복.',
                fullText: `편두통은 '고성능 센서'를 가진 뇌의 특징임. 인식 전환: 참지 말고 관리하는 질환. 조기 예방: 만성화 방지의 지름길. 맞춤 전략: 일기 기반의 개인별 트리거/약물 최적화. 교육: 환자의 자가 관리 능력 배양. 목표: 통증 없는 맑은 일상 회복. 의료진과 환자의 긴밀한 파트너십이 중요함.`,
                hasVisualization: true, visType: 'conclusion',
                table: { headers: ['핵심 전략', '내용', '목표'], rows: [['인식', '질환으로 이해', '치료 순응도↑'], ['예방', '조기 개입', '만성화 방지'], ['관리', 'SEEDS 실천', '삶의 질 향상']] }
            }
        ];

        // UI Logic
        document.addEventListener('DOMContentLoaded', () => {
            const sidebarNav = document.getElementById('sidebar-nav');
            const contentGrid = document.getElementById('content-grid');
            const searchInput = document.getElementById('search-input');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            
            // Generate Sidebar & Content
            migraineData.forEach((section, index) => {
                // Sidebar Link
                const link = document.createElement('a');
                link.href = `#${section.id}`;
                link.className = 'flex items-center px-4 py-3 hover:bg-green-700 hover:text-white transition-colors text-sm rounded-lg mb-1';
                link.innerHTML = `<i class="fas ${section.icon} w-6 text-center mr-3"></i> <span class="truncate">${section.title.split('.')[1]}</span>`;
                sidebarNav.appendChild(link);

                // Card Element
                const card = document.createElement('div');
                card.id = section.id;
                card.className = 'bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 card-hover transition-all duration-300 border-l-4 border-mg-primary';
                
                // Visualization Placeholder (Simplified Logic)
                let visualContent = '';
                if (section.hasChart) {
                    visualContent = `<div class="h-48 mt-4 bg-green-50 dark:bg-gray-700 rounded-lg p-2 relative"><canvas id="chart-${index}"></canvas></div>`;
                } else if (section.hasVisualization) {
                    visualContent = getVisualHTML(section.visType, index);
                }

                // Table HTML
                let tableContent = '';
                if (section.table) {
                    const rows = section.table.rows.map(r => `<tr>${r.map(d => `<td class="px-3 py-2 border-b dark:border-gray-600">${d}</td>`).join('')}</tr>`).join('');
                    tableContent = `
                        <div class="overflow-x-auto mt-4 hidden" id="table-${index}">
                            <table class="min-w-full text-xs text-left">
                                <thead class="bg-green-100 dark:bg-gray-700 text-mg-primary dark:text-green-300">
                                    <tr>${section.table.headers.map(h => `<th class="px-3 py-2 font-semibold">${h}</th>`).join('')}</tr>
                                </thead>
                                <tbody>${rows}</tbody>
                            </table>
                        </div>
                    `;
                }

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center">
                            <div class="p-2 bg-green-100 dark:bg-gray-700 rounded-lg text-mg-primary mr-3">
                                <i class="fas ${section.icon} fa-lg"></i>
                            </div>
                            <h3 class="text-xl font-bold text-gray-800 dark:text-white">${section.title}</h3>
                        </div>
                        <div class="flex space-x-2">
                             ${section.table ? `<button onclick="toggleView('${index}')" class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-600 rounded hover:bg-green-200" title="표/시각화 전환"><i class="fas fa-table"></i></button>` : ''}
                        </div>
                    </div>
                    
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 font-medium">${section.shortDesc}</p>
                    
                    <div id="vis-container-${index}">
                        ${visualContent}
                    </div>
                    ${tableContent}

                    <div class="mt-4">
                        <div class="h-0 overflow-hidden transition-all duration-500" id="desc-${index}">
                             <p class="text-sm text-gray-700 dark:text-gray-300 leading-relaxed p-3 bg-mg-light dark:bg-gray-900 rounded-lg border border-green-100 dark:border-gray-700">${section.fullText}</p>
                        </div>
                        <button onclick="toggleDesc('${index}')" class="w-full mt-2 text-center text-xs font-bold text-mg-primary hover:text-green-700 uppercase tracking-wider py-2 border-t border-dashed border-gray-300 dark:border-gray-700">
                            상세 설명 보기 <i class="fas fa-chevron-down ml-1"></i>
                        </button>
                    </div>
                `;
                contentGrid.appendChild(card);
            });

            // Init Charts
            initCharts();

            // Search Function
            searchInput.addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                document.querySelectorAll('#content-grid > div').forEach(card => {
                    const text = card.innerText.toLowerCase();
                    card.style.display = text.includes(term) ? 'block' : 'none';
                });
            });

            // Theme Toggle
            const themeToggle = document.getElementById('theme-toggle');
            themeToggle.addEventListener('click', () => {
                document.documentElement.classList.toggle('dark');
                // Re-render charts if needed for color adaptation
            });
            
            // Mobile Menu
            const aside = document.querySelector('aside');
            mobileMenuBtn.addEventListener('click', () => {
                aside.classList.toggle('hidden');
                aside.classList.toggle('absolute');
                aside.classList.toggle('h-full');
            });
        });

        // Helper Functions
        function toggleDesc(index) {
            const el = document.getElementById(`desc-${index}`);
            const btn = el.nextElementSibling;
            if (el.classList.contains('h-0')) {
                el.classList.remove('h-0');
                el.classList.add('h-auto');
                btn.innerHTML = `접기 <i class="fas fa-chevron-up ml-1"></i>`;
            } else {
                el.classList.add('h-0');
                el.classList.remove('h-auto');
                btn.innerHTML = `상세 설명 보기 <i class="fas fa-chevron-down ml-1"></i>`;
            }
        }

        function toggleView(index) {
            const vis = document.getElementById(`vis-container-${index}`);
            const tab = document.getElementById(`table-${index}`);
            if (vis && tab) {
                if (vis.classList.contains('hidden')) {
                    vis.classList.remove('hidden');
                    tab.classList.add('hidden');
                } else {
                    vis.classList.add('hidden');
                    tab.classList.remove('hidden');
                }
            }
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        function showModal(title, content) {
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-body').innerHTML = content;
            const modal = document.getElementById('info-modal');
            const modalContent = document.getElementById('modal-content');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('info-modal');
            const modalContent = document.getElementById('modal-content');
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }, 300);
        }

        // Simulating Non-Chart Visualizations with HTML/CSS
        function getVisualHTML(type, index) {
            const colors = ['bg-green-200', 'bg-green-300', 'bg-green-400', 'bg-green-500'];
            
            if (type === 'timeline') {
                return `
                    <div class="flex items-center justify-between text-xs text-center mt-6 relative px-2">
                        <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-200 -z-10 transform -translate-y-1/2"></div>
                        ${['전구기', '전조기', '두통기', '후구기'].map((p, i) => `
                            <div class="group cursor-pointer" onclick="alert('${p} 상세정보')">
                                <div class="w-8 h-8 rounded-full ${colors[i]} border-2 border-white shadow flex items-center justify-center text-white font-bold mb-1 group-hover:scale-125 transition">${i+1}</div>
                                <span class="font-semibold text-gray-600 dark:text-gray-400">${p}</span>
                            </div>
                        `).join('')}
                    </div>`;
            } else if (type === 'seeds-cards') {
                return `
                    <div class="flex justify-between gap-1 mt-4">
                        ${['S','E','E','D','S'].map((l, i) => `
                            <div class="flex-1 bg-mg-light dark:bg-green-900 rounded p-2 text-center border border-green-200 cursor-pointer hover:bg-green-200 transition" title="클릭하여 상세 보기">
                                <div class="text-xl font-bold text-mg-primary">${l}</div>
                                <div class="text-[10px] text-gray-500">${['Sleep','Exercise','Eat','Diary','Stress'][i]}</div>
                            </div>
                        `).join('')}
                    </div>`;
            } else if (type === 'botox-map') {
                return `<div class="h-48 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center relative overflow-hidden group">
                    <i class="fas fa-head-side-mask text-9xl text-gray-300"></i>
                    <div class="absolute top-10 left-1/2 w-3 h-3 bg-red-500 rounded-full animate-ping"></div>
                    <div class="absolute top-10 left-1/2 w-3 h-3 bg-red-500 rounded-full cursor-pointer" title="이마 주사점"></div>
                    <div class="absolute top-16 left-[55%] w-3 h-3 bg-red-500 rounded-full cursor-pointer" title="관자놀이 주사점"></div>
                    <div class="absolute top-24 left-[45%] w-3 h-3 bg-red-500 rounded-full cursor-pointer" title="뒷목 주사점"></div>
                    <div class="absolute bottom-2 text-xs text-gray-500">점(Point)을 클릭하세요</div>
                </div>`;
            } else if (type === 'clock-warning') {
                return `<div class="flex items-center justify-center h-48 bg-orange-50 dark:bg-gray-700 rounded-lg border border-orange-200">
                    <div class="text-center">
                        <i class="fas fa-stopwatch text-5xl text-orange-500 mb-2 animate-pulse"></i>
                        <h4 class="font-bold text-orange-700 dark:text-orange-300">Golden Hour</h4>
                        <p class="text-xs">두통 시작 <span class="font-bold underline">1시간 이내</span> 복용 필수!</p>
                    </div>
                </div>`;
            }
            return `<div class="h-40 bg-gray-50 dark:bg-gray-700 flex items-center justify-center text-gray-400 rounded-lg text-sm border-2 border-dashed border-gray-200">
                <i class="fas fa-image mr-2"></i> ${type} 시각화 자료 영역
            </div>`;
        }

        function initCharts() {
            // Section 1: Prevalence Chart
            new Chart(document.getElementById('chart-0'), {
                type: 'bar',
                data: {
                    labels: ['남성', '여성'],
                    datasets: [{
                        label: '유병률 (%)',
                        data: [12.8, 25.9],
                        backgroundColor: ['#A7F3D0', '#2E8B57'],
                        borderWidth: 1
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });

            // Section 4: Triggers Radar
            const radarCtx = document.getElementById('chart-3');
            if(radarCtx) {
                new Chart(radarCtx, {
                    type: 'radar',
                    data: {
                        labels: ['스트레스', '수면부족', '공복', '날씨/기압', '빛/소리', '냄새'],
                        datasets: [{
                            label: '빈도',
                            data: [80, 70, 50, 40, 60, 30],
                            backgroundColor: 'rgba(46, 139, 87, 0.2)',
                            borderColor: '#2E8B57',
                            pointBackgroundColor: '#fff'
                        }]
                    },
                    options: { responsive: true, maintainAspectRatio: false, scales: { r: { suggestedMin: 0 } } }
                });
            }

            // Section 8: Triptan Doughnut
            const triptanCtx = document.getElementById('chart-7');
            if(triptanCtx) {
                new Chart(triptanCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['2시간내 효과(성공)', '효과 없음/재발'],
                        datasets: [{
                            data: [65, 35],
                            backgroundColor: ['#2E8B57', '#e5e7eb'],
                            hoverOffset: 4
                        }]
                    },
                    options: { 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        cutout: '70%',
                        plugins: { 
                            title: { display: true, text: '일반적인 트립탄 반응률' } 
                        }
                    }
                });
            }
             // Section 14: MOH Bar
             const mohCtx = document.getElementById('chart-13');
             if(mohCtx) {
                new Chart(mohCtx, {
                    type: 'bar',
                    data: {
                        labels: ['트립탄/복합제', '단순 진통제'],
                        datasets: [{
                            label: '월 허용 한계일(일)',
                            data: [10, 15],
                            backgroundColor: ['#EF4444', '#F59E0B']
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { title: { display: true, text: '약물 과용 위험 기준선' }}
                    }
                });
             }
        }
    </script>
</body>
</html>